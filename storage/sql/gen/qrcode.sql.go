// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: qrcode.sql

package sqlc

import (
	"context"

	"github.com/jackc/pgx/v5/pgtype"
)

const createQrcode = `-- name: CreateQrcode :one
INSERT INTO qrcodes (code, schedule_id) VALUES ($1, $2) RETURNING id, code, schedule_id
`

type CreateQrcodeParams struct {
	Code       pgtype.Text
	ScheduleID pgtype.Int4
}

func (q *Queries) CreateQrcode(ctx context.Context, arg CreateQrcodeParams) (Qrcodes, error) {
	row := q.db.QueryRow(ctx, createQrcode, arg.Code, arg.ScheduleID)
	var i Qrcodes
	err := row.Scan(&i.ID, &i.Code, &i.ScheduleID)
	return i, err
}

const getQrcodeByScheduleID = `-- name: GetQrcodeByScheduleID :one
SELECT id, code, schedule_id FROM qrcodes WHERE schedule_id = $1
`

func (q *Queries) GetQrcodeByScheduleID(ctx context.Context, scheduleID pgtype.Int4) (Qrcodes, error) {
	row := q.db.QueryRow(ctx, getQrcodeByScheduleID, scheduleID)
	var i Qrcodes
	err := row.Scan(&i.ID, &i.Code, &i.ScheduleID)
	return i, err
}

const getSchedule = `-- name: GetSchedule :one
SELECT id, subject_id, group_id, room_id, teacher_id, the_time FROM schedule WHERE id = $1
`

type GetScheduleRow struct {
	ID        int32
	SubjectID pgtype.Text
	GroupID   pgtype.Text
	RoomID    pgtype.Text
	TeacherID pgtype.Text
	TheTime   pgtype.Timestamp
}

func (q *Queries) GetSchedule(ctx context.Context, id int32) (GetScheduleRow, error) {
	row := q.db.QueryRow(ctx, getSchedule, id)
	var i GetScheduleRow
	err := row.Scan(
		&i.ID,
		&i.SubjectID,
		&i.GroupID,
		&i.RoomID,
		&i.TeacherID,
		&i.TheTime,
	)
	return i, err
}

const upsertAttendance = `-- name: UpsertAttendance :exec
INSERT INTO marks_and_absence (schedule_id, student_id, status)
VALUES ($1, $2, $3)
ON CONFLICT (schedule_id, student_id)
DO UPDATE SET status = EXCLUDED.status
`

type UpsertAttendanceParams struct {
	ScheduleID int32
	StudentID  string
	Status     pgtype.Text
}

func (q *Queries) UpsertAttendance(ctx context.Context, arg UpsertAttendanceParams) error {
	_, err := q.db.Exec(ctx, upsertAttendance, arg.ScheduleID, arg.StudentID, arg.Status)
	return err
}
